"use strict";(self["webpackChunkrolling"]=self["webpackChunkrolling"]||[]).push([[39],{5679:function(t,e,o){function a(t){return{all:t=t||new Map,on:function(e,o){var a=t.get(e);a?a.push(o):t.set(e,[o])},off:function(e,o){var a=t.get(e);a&&(o?a.splice(a.indexOf(o)>>>0,1):t.set(e,[]))},emit:function(e,o){var a=t.get(e);a&&a.slice().map((function(t){t(o)})),(a=t.get("*"))&&a.slice().map((function(t){t(e,o)}))}}}o.d(e,{Z:function(){return c}});const r=a();var c=r},7587:function(t,e,o){o.d(e,{Z:function(){return r}});var a=o(5679);function r(t,e="更新"){const o="string"===typeof t.data.message?[t.data.message]:t.data.message;t.data.success?a.Z.emit("push-message",{style:"success",title:`${e}成功`,content:o.toString()}):a.Z.emit("push-message",{style:"danger",title:`${e}失敗`,content:o.join("、")})}},4677:function(t,e,o){var a=o(7587),r=o(5679),c=o(6154),n=o(9876),i=o(6294);const s=(0,i.Z)();e.Z=(0,n.Q_)("cartStore",{state:()=>({cartProducts:{},cartProductsData:[],status:{loadingItem:""}}),actions:{async addCart(t){s.cartLoadingItem=t;const e="https://vue3-course-api.hexschool.io/api/je-api/cart",o={product_id:t,qty:1};try{const t=await c.Z.post(e,{data:o});s.cartLoadingItem="",(0,a.Z)(t),r.Z.emit("updateCart")}catch(n){console.error("Error 找不到資料",n)}},async getCartProducts(){const t="https://vue3-course-api.hexschool.io/api/je-api/cart";try{const e=await c.Z.get(t);this.cartProducts=e.data.data,this.cartProductsData=e.data.data.carts}catch(e){console.error("Error 找不到資料",e)}},async updateCart(t,e){s.isLoadingForStore=!0,s.cartLoadingItem=t.id;const o=`https://vue3-course-api.hexschool.io/api/je-api/cart/${t.id}`,n={product_id:t.product_id,qty:e};try{const t=await c.Z.put(o,{data:n});s.isLoadingForStore=!1,s.cartLoadingItem="",this.getCartProducts(),(0,a.Z)(t),r.Z.emit("updateCart")}catch(i){console.error("Error 找不到資料",i)}},async delProduct(t){s.cartLoadingItem=t,s.isLoadingForStore=!0;const e=`https://vue3-course-api.hexschool.io/api/je-api/cart/${t}`;try{const t=await c.Z["delete"](e);s.isLoadingForStore=!1,s.cartLoadingItem="",this.getCartProducts(),(0,a.Z)(t),r.Z.emit("updateCart")}catch(o){console.error("Error 找不到資料",o)}},async addCouponCode(t){s.isLoadingForStore=!0;const e="https://vue3-course-api.hexschool.io/api/je-api/coupon",o={code:t};try{const t=await c.Z.post(e,{data:o});s.isLoadingForStore=!1,this.getCartProducts(),(0,a.Z)(t)}catch(r){console.error("Error 找不到資料",r)}},scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})}}})},6294:function(t,e,o){var a=o(9876);e.Z=(0,a.Q_)("statusStore",{state:()=>({isLoadingForStore:!1,cartLoadingItem:""})})},6129:function(t,e,o){o.d(e,{Z:function(){return l}});var a=o(6252),r=o(3577);const c={class:"page-title-lg"};function n(t,e,o,n,i,s){return(0,a.wg)(),(0,a.iD)("div",c,[(0,a._)("h3",null,(0,r.zw)(o.title),1)])}var i={props:{title:String}},s=o(3744);const d=(0,s.Z)(i,[["render",n]]);var l=d},9039:function(t,e,o){o.r(e),o.d(e,{default:function(){return O}});var a=o(6252),r=o(9963),c=o(3577);const n={class:"cart-box"},i={key:0,class:"cart"},s={class:"cart-box"},d={class:"coupon"},l=(0,a._)("label",{for:"coupon",class:"text-deep"},"優惠代碼",-1),u={class:"price-sm text-deep"},p=["onClick","disabled"],g={class:"img-box"},m=["src"],h={class:"content text-deep"},_={class:"control"},f=["onClick","disabled"],y=(0,a._)("i",{class:"bi bi-dash text-deep"},null,-1),C=[y],v=["onUpdate:modelValue","onChange","disabled"],w=["onClick"],k=(0,a._)("i",{class:"bi bi-plus text-deep"},null,-1),b=[k],P={key:0},Z={class:"price text-deep"},x=["onClick","disabled"],L={key:0},I={key:1},$={class:"total"},D={key:0},S=(0,a._)("i",{class:"bi bi-dash"},null,-1),q={key:1},U={class:"checkout"},T={class:"coupon"},z=(0,a._)("label",{for:"coupon",class:"text-deep"},"優惠代碼",-1),F={key:1,class:"cart-no-data"},j=(0,a._)("h2",null,"購物車暫無商品",-1),M={key:2,class:"check-box bg-color"};function N(t,e,o,y,k,N){const E=(0,a.up)("PageTitle"),W=(0,a.up)("router-link"),V=(0,a.up)("Loading");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(E,{title:"購物車"}),(0,a._)("div",n,[0!==t.cartProducts.total?((0,a.wg)(),(0,a.iD)("div",i,[(0,a._)("div",s,[(0,a._)("div",d,[l,(0,a.wy)((0,a._)("input",{type:"text",name:"",id:"coupon",placeholder:"請輸入優惠券代碼","onUpdate:modelValue":e[0]||(e[0]=t=>k.couponCode=t),onChange:e[1]||(e[1]=e=>t.addCouponCode(k.couponCode))},null,544),[[r.nr,k.couponCode]])]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.cartProducts.carts,(e=>((0,a.wg)(),(0,a.iD)("div",{class:"cart-item",key:e.id},[(0,a._)("div",u,[(0,a._)("a",{href:"",class:"text-deep",onClick:(0,r.iM)((o=>t.delProduct(e.id)),["prevent"]),disabled:e.id===t.cartLoadingItem.loadingItem}," 移除購物車 ",8,p)]),(0,a._)("div",g,[(0,a._)("img",{src:e.product.imageUrl,alt:"  "},null,8,m)]),(0,a._)("div",h,[(0,a._)("p",null,(0,c.zw)(e.product.category),1),(0,a._)("p",null,(0,c.zw)(e.product.title),1),(0,a._)("div",_,[(0,a._)("button",{onClick:(0,r.iM)((o=>t.updateCart(e,e.qty-1)),["prevent"]),disabled:1===e.qty&&e.id===t.cartLoadingItem.loadingItem},C,8,f),(0,a.wy)((0,a._)("input",{type:"number",name:"",id:"qty",min:"1","onUpdate:modelValue":t=>e.qty=t,onChange:o=>t.updateCart(e,e.qty),disabled:e.id===t.cartLoadingItem.loadingItem},null,40,v),[[r.nr,e.qty,void 0,{number:!0}]]),(0,a._)("button",{onClick:(0,r.iM)((o=>t.updateCart(e,e.qty+1)),["prevent"])},b,8,w)]),e.coupon?((0,a.wg)(),(0,a.iD)("small",P,[(0,a._)("em",null,"已套用"+(0,c.zw)(e.coupon.code)+"優惠券",1)])):(0,a.kq)("",!0)]),(0,a._)("div",Z,[(0,a._)("a",{href:"",class:"text-deep",onClick:(0,r.iM)((o=>t.delProduct(e.id)),["prevent"]),disabled:e.id===t.cartLoadingItem.loadingItem}," 移除購物車 ",8,x),(0,a._)("p",null,[e.coupon?((0,a.wg)(),(0,a.iD)("span",I,[(0,a._)("del",null,"NT$"+(0,c.zw)(t.$filters.currency(e.total)),1),(0,a._)("h5",null,"NT$"+(0,c.zw)(t.$filters.currency(e.final_total)),1)])):((0,a.wg)(),(0,a.iD)("span",L,"NT$"+(0,c.zw)(t.$filters.currency(e.total)),1))])])])))),128)),(0,a._)("div",$,[(0,a._)("p",null,[(0,a.Uk)(" 總金額 "),(0,a._)("span",null,"NT$"+(0,c.zw)(t.$filters.currency(t.cartProducts.total)),1)]),t.cartProducts.total!==t.cartProducts.final_total?((0,a.wg)(),(0,a.iD)("p",D,[(0,a.Uk)(" 折扣 "),(0,a._)("span",null,[S,(0,a.Uk)(" NT$"+(0,c.zw)(t.$filters.currency(t.cartProducts.total-t.cartProducts.final_total)),1)])])):(0,a.kq)("",!0),t.cartProducts.total!==t.cartProducts.final_total?((0,a.wg)(),(0,a.iD)("p",q,[(0,a.Uk)(" 最終金額 "),(0,a._)("span",null," NT$"+(0,c.zw)(t.$filters.currency(t.cartProducts.final_total)),1)])):(0,a.kq)("",!0)])]),(0,a._)("div",U,[(0,a._)("div",T,[z,(0,a.wy)((0,a._)("input",{type:"text",name:"",id:"coupon",placeholder:"請輸入優惠券代碼","onUpdate:modelValue":e[2]||(e[2]=t=>k.couponCode=t),onChange:e[3]||(e[3]=e=>t.addCouponCode(k.couponCode))},null,544),[[r.nr,k.couponCode]])]),(0,a.Wm)(W,{to:{name:"訂單填寫"},class:"border-btn text-deep"},{default:(0,a.w5)((()=>[(0,a.Uk)(" 訪客結帳 ")])),_:1})])])):((0,a.wg)(),(0,a.iD)("div",F,[j,(0,a.Wm)(W,{to:{name:"所有產品"},class:"border-btn text-deep"},{default:(0,a.w5)((()=>[(0,a.Uk)(" 前往選購 ")])),_:1})])),0!==t.cartProducts.total?((0,a.wg)(),(0,a.iD)("div",M,[(0,a.Wm)(W,{to:{name:"訂單填寫"},class:"border-btn text-deep"},{default:(0,a.w5)((()=>[(0,a.Uk)(" 訪客結帳 ")])),_:1})])):(0,a.kq)("",!0)]),(0,a.Wm)(V,{active:t.isLoadingForStore},null,8,["active"])],64)}var E=o(6129),W=o(9876),V=o(4677),H=o(6294),Q={components:{PageTitle:E.Z},data(){return{min:1,max:10,couponCode:""}},computed:{...(0,W.rn)(V.Z,["cartProducts"]),...(0,W.rn)(H.Z,["isLoadingForStore","cartLoadingItem"])},methods:{...(0,W.nv)(V.Z,["getCartProducts","updateCart","delProduct","addCouponCode"])},created(){this.getCartProducts()},inject:["emitter","pushMessageState"]},Y=o(3744);const K=(0,Y.Z)(Q,[["render",N]]);var O=K}}]);
//# sourceMappingURL=39.180f1657.js.map