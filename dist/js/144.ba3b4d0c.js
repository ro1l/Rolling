"use strict";(self["webpackChunkrolling"]=self["webpackChunkrolling"]||[]).push([[144],{4144:function(e,o,t){t.r(o),t.d(o,{default:function(){return ce}});var a=t(6252),l=t(3577);const s={class:"container-fluid"},n={class:"row"},d={class:"col-12 border-bottom border-black"},i={class:"container-fluid d-flex justify-content-between align-items-center p-4"},p=(0,a._)("h1",{class:"page-title"},"Coupons",-1),r=(0,a._)("i",{class:"bi bi-plus-lg"},null,-1),c={class:"col-12"},u={class:"card mb-4 bg-gray-white"},m={class:"card-body pt-lg-4 mt-lg-3 py-0 px-lg-5"},b={class:"table-responsive p-0 d-flex"},h={class:"table lh-lg mb-0 table-hover"},g=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{class:"text-secondary text-xxs fw-normal pb-lg-4 pt-sm-0"},"名稱"),(0,a._)("th",{class:"text-secondary text-xxs fw-normal pb-lg-4 pt-sm-0"},"code"),(0,a._)("th",{class:"text-secondary text-xxs fw-normal pb-lg-4 pt-sm-0"},"百分比"),(0,a._)("th",{class:"text-secondary text-xxs fw-normal pb-lg-4 pt-sm-0"},"期限"),(0,a._)("th",{class:"text-secondary text-xxs fw-normal pb-lg-4 pt-sm-0 text-center"}," 啟用 ")])],-1),_=["onClick"],f={class:"text-center"},x={key:0},y=(0,a._)("i",{class:"bi bi-check-lg fs-5"},null,-1),w=[y],C={key:1};function v(e,o,t,y,v,k){const M=(0,a.up)("DashboardSkeleton"),D=(0,a.up)("Pagination"),L=(0,a.up)("CouponModal"),S=(0,a.up)("DelModal"),$=(0,a.up)("Loading");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",s,[(0,a._)("div",n,[(0,a._)("div",d,[(0,a._)("div",i,[p,(0,a._)("button",{class:"btn btn-outline-dark border-1 rounded-0 me-lg-3 mb-0 px-lg-5 py-lg-2",onClick:o[0]||(o[0]=e=>k.openModal(!0))},[r,(0,a.Uk)(" 新增優惠券 ")])])]),v.isLoadingForSkeleton?((0,a.wg)(),(0,a.j4)(M,{key:0})):(0,a.kq)("",!0),(0,a._)("div",c,[(0,a._)("div",u,[(0,a._)("div",m,[(0,a._)("div",b,[(0,a._)("table",h,[g,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(v.coupons,(o=>((0,a.wg)(),(0,a.iD)("tr",{class:"cursor-pointer",onClick:e=>k.openModal(!1,o),key:o.id},[(0,a._)("td",null,(0,l.zw)(o.title),1),(0,a._)("td",null,(0,l.zw)(o.code),1),(0,a._)("td",null,(0,l.zw)(o.percent),1),(0,a._)("td",null,(0,l.zw)(e.$filters.date(o.due_date)),1),(0,a._)("td",f,[1===o.is_enabled?((0,a.wg)(),(0,a.iD)("span",x,w)):((0,a.wg)(),(0,a.iD)("span",C))])],8,_)))),128))])])])]),(0,a.Wm)(D,{pages:v.pagination,onEmitPages:k.getCoupons},null,8,["pages","onEmitPages"])])])])]),(0,a.Wm)(L,{ref:"couponModal",coupon:v.tempCoupon,isNew:v.isNew,onUpdateCoupon:k.updateCoupon,onDelCoupon:o[1]||(o[1]=e=>k.openDelModal(v.tempCoupon))},null,8,["coupon","isNew","onUpdateCoupon"]),(0,a.Wm)(S,{ref:"delModal",item:v.tempCoupon,onDelItem:k.delCoupon},null,8,["item","onDelItem"]),(0,a.Wm)($,{active:v.isLoading,zIndex:1e4},null,8,["active"])],64)}var k=t(6154),M=t(9963);const D={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},L={class:"modal-dialog modal-xl modal-dialog-centered modal-fullscreen-md-down"},S={class:"modal-content bg-gray-white rounded-0 p-0 border-0"},$=(0,a._)("div",{class:"modal-header border-bottom border-black p-4"},[(0,a._)("h1",{class:"modal-title fs-5 font-family-taipei fw-normal",id:"exampleModalLabel"},"新增/編輯優惠券"),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),j={class:"modal-body p-0"},U={class:"container-fluid"},Z={class:"row p-0"},N={class:"col-lg-6 col-sm-12"},F={class:"card border-lg border-end border-black px-2 py-4"},V=(0,a._)("div",{class:"card-header pb-2 mb-0"},[(0,a._)("h6",{class:"mb-0 fs-5 font-family-taipei"},"Coupon")],-1),z={class:"card-body"},E={class:"mb-4"},I=(0,a._)("p",{class:"mb-2 text-black"},"名稱",-1),P={class:"mb-4"},T=(0,a._)("p",{class:"mb-2 text-black"},"code",-1),W={class:"mb-4"},q=(0,a._)("p",{class:"mb-2 text-black"},"百分比",-1),G={class:"mb-4"},H=(0,a._)("p",{class:"mb-2 text-black"},"期限",-1),O={class:"col-lg-6 col-sm-12"},Y={class:"card border-lg px-2 py-4"},B=(0,a._)("div",{class:"card-header pb-2 mb-0"},[(0,a._)("h6",{class:"mb-0 fs-5 font-family-taipei"},"是否啟用")],-1),K={class:"card-body"},A={class:"px-5 pt-5 d-flex justify-content-between align-items-center"},J=(0,a._)("label",{for:"true",class:"true px-lg-5 py-lg-2 px-4 py-1 cursor-pointer border-2 rounded-5 fs-5"},[(0,a._)("span",null,"是")],-1),Q=(0,a._)("label",{for:"false",class:"false px-lg-5 py-lg-2 px-4 py-1 cursor-pointer border-2 rounded-5 fs-5"},[(0,a._)("span",null,"否")],-1),R={class:"modal-footer d-flex justify-content-between p-lg-5 border-top border-black p-3 bg-sm-color"},X=(0,a._)("p",null,null,-1);function ee(e,o,t,l,s,n){return(0,a.wg)(),(0,a.iD)("div",D,[(0,a._)("div",L,[(0,a._)("div",S,[$,(0,a._)("div",j,[(0,a._)("div",U,[(0,a._)("div",Z,[(0,a._)("div",N,[(0,a._)("div",F,[V,(0,a._)("div",z,[(0,a._)("div",E,[I,(0,a.wy)((0,a._)("input",{class:"form-control border-dark rounded-0 border-1 bg-transparent p-3",type:"text",placeholder:"請輸入名稱","aria-label":"example","onUpdate:modelValue":o[0]||(o[0]=e=>s.tempCoupon.title=e)},null,512),[[M.nr,s.tempCoupon.title]])]),(0,a._)("div",P,[T,(0,a.wy)((0,a._)("input",{class:"form-control border-dark rounded-0 border-1 bg-transparent p-3",type:"text",placeholder:"請輸入code","aria-label":"example","onUpdate:modelValue":o[1]||(o[1]=e=>s.tempCoupon.code=e)},null,512),[[M.nr,s.tempCoupon.code]])]),(0,a._)("div",W,[q,(0,a.wy)((0,a._)("input",{class:"form-control border-dark rounded-0 border-1 bg-transparent p-3",type:"number",placeholder:"請輸入百分比","aria-label":"example","onUpdate:modelValue":o[2]||(o[2]=e=>s.tempCoupon.percent=e)},null,512),[[M.nr,s.tempCoupon.percent]])]),(0,a._)("div",G,[H,(0,a.wy)((0,a._)("input",{class:"form-control border-dark rounded-0 border-1 bg-transparent p-3",type:"date",placeholder:"請輸入期限","aria-label":"example","onUpdate:modelValue":o[3]||(o[3]=e=>s.due_date=e)},null,512),[[M.nr,s.due_date]])])])])]),(0,a._)("div",O,[(0,a._)("div",Y,[B,(0,a._)("div",K,[(0,a._)("div",A,[(0,a.wy)((0,a._)("input",{class:"d-none input-true",type:"radio",name:"select",id:"true",value:1,"onUpdate:modelValue":o[4]||(o[4]=e=>s.tempCoupon.is_enabled=e),checked:""},null,512),[[M.G2,s.tempCoupon.is_enabled]]),J,(0,a.wy)((0,a._)("input",{class:"d-none input-false",type:"radio",name:"select",id:"false",value:0,"onUpdate:modelValue":o[5]||(o[5]=e=>s.tempCoupon.is_enabled=e)},null,512),[[M.G2,s.tempCoupon.is_enabled]]),Q])])])])])])]),(0,a._)("div",R,[!1===t.isNew?((0,a.wg)(),(0,a.iD)("button",{key:0,type:"button",class:"btn btn-outline-dark rounded-5 me-3 mb-0 px-lg-5 py-lg-3 px-4 py-2",onClick:o[6]||(o[6]=o=>e.$emit("del-coupon",s.tempCoupon))},"刪除")):(0,a.kq)("",!0),X,(0,a._)("button",{type:"button",class:"btn btn-dark rounded-5 me-3 mb-0 px-lg-5 py-lg-3 px-4 py-2",onClick:o[7]||(o[7]=o=>e.$emit("update-coupon",s.tempCoupon))},"確認")])])])],512)}var oe=t(1339),te={props:{coupon:{type:Object,default(){return{}}},isNew:{type:Boolean,required:!0}},data(){return{modal:{},tempCoupon:{},due_date:""}},watch:{coupon(){this.tempCoupon=this.coupon;const e=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T");[this.due_date]=e},due_date(){this.tempCoupon.due_date=Math.floor(new Date(this.due_date)/1e3)}},emits:["update-coupon","del-coupon"],mixins:[oe.Z]},ae=t(3744);const le=(0,ae.Z)(te,[["render",ee]]);var se=le,ne=t(6463),de=t(7130),ie=t(552),pe={components:{CouponModal:se,DelModal:ne.Z,Pagination:de.Z,DashboardSkeleton:ie.Z},data(){return{coupons:{},tempCoupon:{},isNew:!1,pagination:{},isLoading:!1,isLoadingForSkeleton:!1}},methods:{async getCoupons(e=1){window.scrollTo({top:0,behavior:"smooth"});try{this.isLoadingForSkeleton=!0;const o=`https://vue3-course-api.hexschool.io/api/je-api/admin/coupons/?page=${e}`,t=await k.Z.get(o);this.coupons=t.data.coupons,this.pagination=t.data.pagination,window.scrollTo({top:0,behavior:"smooth"})}catch(o){console.error("Error 找不到資料",o)}this.isLoadingForSkeleton=!1},openModal(e,o){this.isLoading=!0,this.tempCoupon=e?{due_date:(new Date).getTime()/1e3,is_enabled:1}:{...o},this.isNew=e,this.isLoading=!1,this.$refs.couponModal.showModal()},async updateCoupon(e){try{this.isLoadingForSkeleton=!0,this.tempCoupon=e;let o="https://vue3-course-api.hexschool.io/api/je-api/admin/coupon",t="post";this.$refs.couponModal.hideModal(),this.getCoupons(),this.isNew||(o=`https://vue3-course-api.hexschool.io/api/je-api/admin/coupon/${e.id}`,t="put");const a=await k.Z[t](o,{data:this.tempCoupon});this.pushMessageState(a),this.isLoadingForSkeleton=!1,this.$refs.couponModal.hideModal(),this.getCoupons()}catch(o){console.error("Error 找不到資料:",o)}},openDelModal(e){this.isLoading=!0,this.tempCoupon={...e},this.isLoading=!1,this.$refs.delModal.showModal()},async delCoupon(){try{this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/je-api/admin/coupon/${this.tempCoupon.id}`,o=await k.Z["delete"](e);this.isLoading=!1,this.$refs.delModal.hideModal(),this.getCoupons(),this.pushMessageState(o),this.$refs.couponModal.hideModal()}catch(e){console.error("Error 找不到資料:",e)}}},created(){this.getCoupons()},inject:["emitter","pushMessageState"]};const re=(0,ae.Z)(pe,[["render",v]]);var ce=re}}]);
//# sourceMappingURL=144.ba3b4d0c.js.map